.\" Manpage for embed
.\" Contact howe.r.j.89@gmail.com to correct errors or typos.
.TH embed 1 "17 Jun 2018" "0.1.0" "embed man page"
.SH NAME
embed \- embed virtual machine
.SH SYNOPSIS
embed out.blk in.blk file.fth
.SH DESCRIPTION
A simple and compact Forth Virtual machine, derived from the H2 CPU
(from <https://github.com/howerj/forth-cpu>, which in turn derives from the J1
CPU). The virtual machine includes a built in eForth image which can be used
in lieu of loading one off of disk.

.SH OPTIONS

All command line arguments are optional, the meaning of the option is given
by its position within the argument list. If any option is missing then a
default is used.

.TP
.B out.blk
This option supplies a file for any 'save' instructions to write a block to,
if no 'out.blk' option is supplied the saving fails. This may be the same
file name as given by 'in.blk'.

.TP
.B in.blk
This option supplies a file to be used as the initial virtual machine image,
this will be loaded at startup. If no 'in.blk' file is provided then the
default virtual machine image built into the library is used to initialize the
virtual machine.

.TP
.B file.fth
This option supplies a file to read from, by default the virtual machine
will read from stdin(3).

.SH EXAMPLES

.TP
.B ./embed

This will make 'embed' use the built in virtual machine image, saving will
fail, and stdin(3) will be used as input.

.TP
.B ./embed out.blk

This will make 'embed' use the built in virtual machine image, saving blocks
will be to the file 'out.blk' and stdin(3) will be used as input.

.TP
.B ./embed out.blk in.blk

This will make 'embed' load the initial virtual machine image from 'in.blk', no
checking is done to make sure this is a valid image, it will just be loaded and
treated as instructions by the virtual machine. 'out.blk' will be used to save
the virtual machine. stdin(3) will be used as input.

.TP
.B ./embed out.blk in.blk file.fth

.SH COMPILATION

Compilation requires a C99 compiler at minimum, an executable called 'b2c' is
made first which can turn a binary file into a C source file that represents
that file. This is then run on the initial eForth image ('embed.blk') to be 
included in the executable to generate 'core.gen.c'. The virtual machine 'embed.c' 
and a driver 'main.c' are then compiled along with 'core.gen.c' into the final
executable 'embed'.

 cc -std=c99 b2c.c -o b2c

 ./b2c embed_default_block embed.blk core.gen.c

 cc -std=c99 main.c embed.c core.gen.c -o embed


.SH LIBRARY API

.SH EXIT STATUS

This command returns zero on success and non zero on failure.

.SH SEE ALSO

For more information, see
.B https://github.com/howerj/embed
which contains the original program source.

.SH BUGS

For any bugs, contact the author.

.SH AUTHOR
Richard James Howe (howe.r.j.89@gmail.com)

.SH COPYRIGHT
The embed program is licensed under the MIT license, Copyright (c) 2018, Richard
Howe. The same applies to the images and source code to generate those images.

